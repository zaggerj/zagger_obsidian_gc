---
created: 2023-11-03T22:29
updated: 2023-11-03T22:29
---
# AngularJS 自定义指令

指令是 AngularJS 中给元素附加功能的一种方式，AngularJS 中有 `ng-if`、`ng-repeat` 等原生指令。除此之外，AngularJS 还支持使用 `directive()` 方法来自定义指令，用于封装一部分功能或是复用元素。

`directive()` 方法接收两个参数：第一个参数是指令的名称，需要采用驼峰命名；第二个参数是指令定义的方法函数，需要返回一个对象，用于描述指令的特征以及相应的处理逻辑。

```js
// 定义指令
angular.module('Demo', []).directive('helloWorld', function () {
  return {
    // ...
  }
})
```

## 1. 指令定义

### restrict 属性 (String)

`restrict` 属性定义了指令的使用方式，分别有：

1. E - Element 元素，仅匹配元素名称，使用方式：`<hello-world></hello-world>`；
2. A - Attribute 属性，仅匹配属性名，使用方式：`<div hello-world></div>`；
3. C - Class 样式，仅匹配样式名称，使用方式：`<div class="hello-world"></div>`
4. M - Comment 注释，仅匹配注释，使用方式: `<!-- hello-world -->`

以上四种使用方式可以组合使用，但通常来说，只推荐通过元素或是属性名的方式来使用指令。

### template 属性 (String | Function)

`template` 属性用于定义指令需要展示的 HTML 模板内容，HTML 模板中必须只有一个根 HTML 标签。`template` 属性可以是一个 HTML 模板字符串，也可以是一个返回 HTML 模板字符串的函数。

```js
angular.module('Demo', []).directive('helloWorld', function () {
    return {
        // 可以是
        template: `<div>hello world</div>`
        // 也可以是
        template: function(element, attrs) {
            return `<div>hello world</div>`
        }
    }
})
```

如果模板的内容太多，还可以将其抽取为一个单独的 HTML 模板文件，然后使用 `templateUrl` 属性来引用这个文件。与 `template` 属性一样，`templateUrl` 属性也支持使用字符串或是函数来定义。

按照指令的用途来说，可以按照是否有模板来将指令分为两类。没有模板的指令是对当前的 DOM 结构附加功能或逻辑；而带有模板的指令是对部分重复 DOM 元素进行复用。

### replace 属性 (Boolean)

`replace` 属性用于指定是否使用 `template` 属性或是 `templateUrl` 属性定义的 HTML 模板内容替换指令所在的 HTML 元素。

```html
<div hello-world></div>
<!-- replace: true -->
<div>hello world</div>
<!-- replace: false -->
<div hello-world>
	<div>hello world</div>
</div>
```

### priority 属性 (Number)

`priority` 属性用于定义指令的优先级，如果在一个元素上使用了多个指令，那么优先级高的指令会先被调用。

### terminal 属性 (Boolean)

`terminal` 属性表示是否在使用了此指令的元素上停止执行优先级更低的指令，但是优先级相同的指令还是会执行。

### scope 属性 (Boolean | Object)

`scope` 属性表示如何为指令的模板设置作用域，为 `scope` 设置不同的值有不同的效果：

```js
angular
    .module('Demo', [])
	.controller('ScopeDemo', function ($scope) {
    	$scope.name = 'ScopeDemo'
    	$scope.title = 'Hello'
	})
```

```html
<div ng-controller="DemoCtrl">
    <div>name: {{ name }}, title: {{ title }}</div>
    <div scope-demo1></div>
    <div scope-demo2></div>
    <div scope-demo3></div>
</div>
```

1. 如果不设置或者设置为 `false`，那么指令会直接将指令的父级作用域用作指令模板的作用域，此时操作指令的作用域会直接修改父级作用域；

```js
angular
    .module('Demo')
	.directive('scopeDemo1', function () {
    	return {
            template: '<div>name: {{ name }}, title: {{ title }}</div>',
            link(scope) {
                scope.title = 'Hello world 1'
            }
        }
	})
```

![](data:image/jpeg;base64,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)

2. 如果设置成 `true`，那么指令会基于指令的父级作用域创建一个新的子作用域用作指令模板的作用域；

```js
angular
    .module('Demo')
	.directive('scopeDemo2', function () {
    	return {
            template: '<div>name: {{ name }}, title: {{ title }}</div>',
            scope: true,
            link(scope) {
                scope.title = 'Hello world 2'
            }
        }
	})
```

![](data:image/jpeg;base64,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)

3. 如果设置成一个对象，则可以隔离指令的作用域，指令的模板此时将无法访问父级作用域。

```js
angular
    .module('Demo')
	.directive('scopeDemo3', function () {
    	return {
            template: '<div>name: {{ name }}, title: {{ title }}</div>',
            scope: {},
            link(scope) {
                scope.title = 'Hello world 3'
            }
        }
	})
```

![](data:image/jpeg;base64,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)

当 `scope` 被设置成对象时，还可以通过 `@`、`=`、`&` 来设置指令属性的绑定规则。

- `=` 双向绑定：本地作用域上的属性同父级作用域上的属性进行双向的数据绑定；
- `@` 本地作用域属性：使用当前指令中的数据和 DOM 属性的值进行绑定；
- `&` 父级作用域绑定：对父级作用域进行绑定，用于抛出事件。

```js
angular
    .module('Demo')
    .controller('ScopeDemo', function ($scope) {
        $scope.name = 'ScopeDemo'
        $scope.title = 'Hello'
        $scope.onEvent = function (...args) {
          alert(args);
        }
	})
	.directive('scopeDemo4', function () {
    	return {
            scope: {
              name: '=',
              title: '@',
              event: '&',
            },
            template: `
            <div>
              <div>name: {{ name }}</div>
              <div>title: {{ title }}</div>
              <button ng-click='onClick()'>click</button></div>
            </div>
            `,
            controller: function ($scope) {
              $scope.onClick = function () {
                $scope.event({ arg1: $scope.name, arg2: $scope.title })
              }
            },
        }
	})
```

```html
<div scope-demo4 name="name" title="Hello4" event="onEvent(arg1, arg2)"></div>
```

![](data:image/jpeg;base64,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)

### transclude 属性 (Boolean | 'element')

`transclude` 属性用于表示是否开启插槽，共有两个可设置的值，分别是 `true` 和 `'element'`：

1. 当设置为 `true` 时，插槽内容是指令所在元素的子元素，需要配合 `template` 属性和 `ng-transclude` 指令一起使用；

```js
angular
    .module('Demo')
	.directive('slotDemo1', function () {
    	return {
            transclude: true,
            template: `
            <div>
              <div>这里是指令模板</div>
              <div ng-transclude></div>
            </div>
            `,
        }
	})
```

```html
<div slot-demo1>
    <div>这里是指令插槽</div>
</div>
```

![](data:image/jpeg;base64,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)

2. 当设置为 `'element'` 时，插槽内容是指令所在的元素的一份克隆，此时为指令设置模板将会失效，指令所在元素会被转换成一个注释节点，并需要在 `link` 函数中手动处理插槽内容；

```js
angular
    .module('Demo')
	.directive('slotDemo2', function () {
    	return {
            transclude: 'element',
            // 此时模板不会生效
            template: `<div>这里是指令模板</div>`,
        }
	})
```

```html
<div slot-demo2>
    <div>这里是指令插槽</div>
</div>

```

![](data:image/png;base64,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)

### controller 函数

`controller` 函数用于定义指令的控制器，可以在其中定义指令相关的一些逻辑和方法，结合使用 `controllerAs` 可以为指令控制器创建别名，用于在指令的模板中使用。

```js
angular
    .module('Demo')
	.directive('controllerDemo', function () {
    	return {
            template: '<div>{{ ctrl.name }}</div>',
            controller() {
                this.name = '1'
            },
            controllerAs: 'ctrl'
        }
	})
```

指令的 `controller` 函数可以获取三个局部服务：

1. `$element`：编译完成的模板元素；
2. `$attrs`：指令所在元素上的元素属性；
3. `$transclude`：处理模板插槽的回调函数，仅在开启 `transclude` 属性时可用。

### reuqire 属性 (String | Array)

`require` 属性用于引用其他指令的控制器，并将控制器实例传递给 `link` 函数的第四个参数。`require` 属性的值是需要引用的其他指令的名称，名称前可以添加两个前缀符号：

1. `^`：在当前元素上未找到此指令时，在父级元素上继续寻找；
2. `?`：未找到此指令时，不抛出错误。

### compile 函数

`compile` 函数用于对指令的模板进行编译处理，共有以下三个参数：

1. `element`：编译完成的模板元素；
2. `attrs`：指令所在元素上的元素属性；
3. ~~`transcludeFn(scope, linkFn)`~~：处理模板插槽的回调函数，仅在开启 `transclude` 属性时可用。

### link 函数

`link` 函数用于链接指令模板和指令的作用域，共接收以下五个参数：

1. `scope`：指令的作用域；
2. `element`：编译完成的模板元素；
3. `attrs`：指令所在元素上的元素属性；
4. `ctrl`：使用 `require` 属性绑定的控制器实例；
5. `transcludeFn(scope, linkFn)`：处理模板插槽的回调函数，仅在开启 `transclude` 属性时可用。

如果声明了 `compile` 函数，那么声明的 `link` 函数将不会被执行。此时 `compile` 函数的返回值会被当做 `link` 函数去执行。

`link` 函数有两种声明方式，第一种是一个函数：

```js
function linkFn (scope, element, attrs, ctrl, transclude) {}
```

第二种是返回一个对象，需要包含 `pre` 和 `post` 两个函数，分别在链接前后执行。

```js
const link = {
    pre(scope, element, attrs, ctrl, transclude) {},
    post(scope, element, attrs, ctrl, transclude) {}
}
```

## 2. 指令插槽

前文已经提到，开启 `transclude` 可以使用指令插槽，设置为 `true` 时需要在指令模板中结合 `ng-transclude` 指令来配合使用。而 `ng-transclude` 只能将插槽的内容进行替换，自由度不高，所以 AngularJS 本身是只支持单插槽的，那么如果想要支持多插槽要怎么办呢？

### transcludeFn 函数

在前面 API 的介绍中，可以看到 AngularJS 在 `compile` 函数、`link` 函数以及 `controller` 函数中都提供了一个 `transcludeFn` 函数，这个函数接收两个参数：

1. `scope`：给插槽元素绑定的作用域，可以不传，默认为指令父级作用域；
2. `linkFn(clone, scope)`：插槽元素的处理回调函数，它会传入两个参数，第一个是插槽元素，第二个是插槽元素所绑定的作用域。

其实，`ng-transclude` 指令的效果也是通过 `transcludeFn` 函数来实现的。但是，通过使用 `transcludeFn` 函数，我们可以对插槽内容做更加自由的处理，例如实现多插槽等等。

通常来说，不建议在 `compile` 函数中使用这个回调函数，具体原因下文再概述。

### transclude: 'element'

前面介绍过，`transclude` 还可以将值设置为 `'element'` ，此时模板不会生效，并且会将指令所在的元素克隆一份做为插槽内容，原来的元素会被转换成一个注释节点。此时，需要我们通过使用 `transcludeFn` 函数来手动处理插槽内容。

```js
angular
    .module('Demo')
	.directive('slotDemo3', function () {
    	return {
            transclude: 'element',
            template: `<div>这里是指令模板</div>`,
            link(scope, element, attrs, ctrl, transclude) {
              transclude(scope, (clone) => {
                const parentNode = element[0].parentNode
                const nextNode = element[0].nextSibling
                const insertNode = document.createDocumentFragment()

                angular.element(insertNode).append(clone)
                parentNode.insertBefore(insertNode, nextNode)
              })
            },
        }
	})
```

其实，有很多的原生指令都是通过 `transclude: 'element'` 来实现的，例如 `ng-if`、`ng-for` 指令等。

## 3. 生命周期

在 AngularJS 中，一个指令的生命周期包含了编译和链接两个阶段，分别对应 `compile` 和 `link` 两个方法。

### compile 阶段

在 `compile` 函数执行的编译阶段，进行编译处理的部分仅包含当前指令的模板，此时插槽也还未插入到模板中。如果模板中的子元素也使用了指令，那么子元素的指令会在它的 `compile` 函数中进行编译处理。

基于以上情况，在指令的 `compile` 阶段进行除了 DOM 变换之外的任何操作都是不安全的，因为子元素使用的指令可能会转换或者克隆其模板的内容，如果在编译阶段对元素进行了事件监听等处理，那么被监听的元素最后可能会因为被移除而导致事件监听器无效。

所以，如果在 `compile` 函数中使用 `transcludeFn` 对指令的插槽做了处理，那么最后可能会导致一些意想不到的 BUG 出现。

除此之外，也不能在指令模板中嵌套使用指令本身，这样会造成指令递归编译，最后造成无限循环和堆栈溢出。

当定义了 `compile` 方法时，另外定义的 `link` 方法就不生效了，此时需要返回一个函数用作 `link` 函数。

当 `compile` 方法对应的编译阶段完成之后，完成处理的元素会被传入 `link` 函数用于进行链接阶段的处理。

### postLink 阶段

链接阶段共分为两部分，分别是 `preLink` 和 `postLink` 。当 `link` 函数被定义成一个函数时，默认这个函数是 `postLink` 。在这个阶段中，可以对元素做一些附加的处理，例如添加事件处理器、处理插槽等等。

### preLink 阶段

`preLink` 函数会在 `postLink` 函数之前执行，在大多数的情况下，只需要 `postLink` 阶段进行处理就可以了。那么在什么情况下需要使用到 preLink 阶段呢？

这里就需要先提一下 `compile` 、`preLink` 以及 `postLink` 三者之间的执行顺序了，如名称所示，首先执行 `compile` 函数进行编译，接着在链接之前执行 `preLink` 函数，然后等待链接完成之后执行 `postLink` 函数。

当指令存在子指令时，这三者的执行顺序会是这样的：首先在父指令上执行 `compile` 和 `preLink` 函数，接着进入子指令的编译阶段，执行子指令的 `compile` 和 `preLink` 函数，然后执行子指令的 `postLink` 函数，最后才是执行父指令的 `postLink` 函数。

如果需要在父子指令间通信，那么就可以使用到 `preLink` 函数了。当子指令继承父指令的作用域或是和父指令共享同一个作用域时，父指令可以在 `preLink` 阶段给作用域赋值，子指令可以读取到父指令设置的值并进行相应的处理。而如果父指令是在 `postLink` 阶段给作用域赋值的话，那么子指令将读取不到父指令设置的值。

> ps：如果不需要在父子指令间通信，无需使用 `preLink` 阶段。

### compile、controller、link 的正确使用

在我看来，`compile` 中只适合对 DOM 进行变换处理，所有的事件注册都应该放到 `link` 中去进行，当需要将指令的方法共享给其他指令时，再考虑使用 `controller` 函数。

### 参考文档

[^1]: [angularjs link compile与controller的区别详解，了解angular生命周期 - 听风是风 - 博客园 (cnblogs.com)](https://www.cnblogs.com/echolun/p/11674869.html)
[^2]: [angularjs指令中的compile与link函数详解_AngularJS_脚本之家 (jb51.net)](http://www.jb51.net/article/58229.htm)
[^3]: [AngularJS: API: $compile](https://code.angularjs.org/1.2.27/docs/api/ng/service/$compile)
[angularjs link compile与controller的区别详解，了解angular生命周期 - 听风是风 - 博客园 (cnblogs.com)](https://www.cnblogs.com/echolun/p/11674869.html)