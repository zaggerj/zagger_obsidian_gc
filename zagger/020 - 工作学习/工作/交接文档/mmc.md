---
title: 'æ–°å¡ç‰‡'
date: '2024-06-28T09:06:34.100Z'
tags: ['inbox']
created: '2024-06-28T09:04:48.836Z'
creator: 'æ—æ±‰é’'
modifier: 'æ—æ±‰é’'
---

<!-- Exported from TiddlyWiki at 17:06, 28th å…­æœˆ 2024 -->

# 1. æ–°å¡ç‰‡

## 1.1. 1.1

 äº¤æ¥-å¤šåª’ä½“å¢è¡¥æ–‡æ¡£

# 2. èƒŒæ™¯

å¤šåª’ä½“äº’åŠ¨æ•™å­¦è½¯ä»¶æ˜¯â¼€å¥—åˆ©ç”¨å¤šåª’ä½“è®¡ç®—æœºè¾…åŠ©æ•™å¸ˆå®Œæˆæ•™å­¦çš„è½¯ä»¶ï¼ˆç±»ä¼¼äºæåŸŸæ•™å®¤ç³»ç»Ÿï¼‰ã€‚æˆ‘ä»¬ç§°ä¸ºå™¢æ˜“å¤šåª’ä½“ç½‘ç»œæ•™å®¤è½¯ä»¶ï¼ˆä¿¡åˆ›ç‰ˆï¼‰ï¼ˆç®€ç§°ï¼šä¿¡åˆ› MMCï¼‰ã€‚ç°åœ¨å…¬å¸å·²æœ‰ windows ç«¯çš„å¤šåª’ä½“ï¼Œä½†ä¸ºäº†å¯åœ¨å›½äº§èŠ¯ç‰‡è®¾å¤‡å’Œå›½äº§æ“ä½œç³»ç»Ÿä¸ŠåŒæ ·é€‚é…ï¼Œåˆ™è¯ç”Ÿäº†ä¿¡åˆ›å¤šåª’ä½“ã€‚

# 3. ä¸šåŠ¡æ¿å—

![](https://img-blog.csdnimg.cn/direct/ea310b4c336b43389c459c4b399d38d0.jpeg#pic_center)

## 3.1. æ¡†æ¶

Electronâ€”â€”æ•™å¸ˆç«¯

> Electron æ˜¯ä¸€ä¸ªä½¿ç”¨ JavaScriptã€HTML å’Œ CSS æ„å»ºæ¡Œé¢åº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€‚ åµŒå…¥ Chromium å’Œ Node.js åˆ° äºŒè¿›åˆ¶çš„ Electron å…è®¸æ‚¨ä¿æŒä¸€ä¸ª JavaScript ä»£ç ä»£ç åº“å¹¶åˆ›å»º åœ¨ Windows ä¸Šè¿è¡Œçš„è·¨å¹³å°åº”ç”¨ macOS å’Œ Linuxâ€”â€”ä¸éœ€è¦æœ¬åœ°å¼€å‘ ç»éªŒã€‚

ç»å…¸é¡¹ç›®ï¼švscodeï¼Œwindows for clash

QTâ€”â€”å­¦ç”Ÿç«¯ï¼ˆåœ¨ 2.1.0 ç‰ˆæœ¬åæ‰æ”¹ä¸º QT å®ç°ï¼Œåœ¨ 2.0.0 ç‰ˆæœ¬æ˜¯ç”±å‰ç«¯ electron å®ç°ï¼‰

> Qt æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„ C++åº”ç”¨ç¨‹åºå¼€å‘æ¡†æ¶ã€‚å¹¿æ³›ç”¨äºå¼€å‘ GUI ç¨‹åºï¼Œè¿™ç§æƒ…å†µä¸‹åˆè¢«ç§°ä¸ºéƒ¨ä»¶å·¥å…·ç®±ã€‚ä¹Ÿå¯ç”¨äºå¼€å‘é GUI ç¨‹åºï¼Œä¾‹å¦‚æ§åˆ¶å°å·¥å…·å’ŒæœåŠ¡å™¨ã€‚
>
>
> GUIï¼šå›¾å½¢ç”¨æˆ·ç•Œé¢

ç»å…¸é¡¹ç›®ï¼šWPSï¼ŒYY è¯­éŸ³ï¼Œå’ªå’•éŸ³ä¹

## 3.2. é€šè®¯æ–¹å¼

æ•™å¸ˆç«¯ä¸ server è¿›ç¨‹ç›¸äº’é€šè®¯ï¼Œå­¦ç”Ÿç«¯ä¸ client è¿›ç¨‹ç›¸äº’é€šè®¯ï¼Œserver è¿›ç¨‹ä¸ client è¿›ç¨‹ç›¸äº’é€šè®¯ã€‚

## 3.3. å‰ç«¯é¡¹ç›®ç»„æˆï¼ˆ2.1.0ï¼‰

å‰ç«¯é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäº Lerna å®ç°çš„ Monorepo é¡¹ç›®ã€‚

* teacher-uiï¼šæ•™å¸ˆç«¯é¡µé¢

* setup-uiï¼šåˆå§‹åŒ–é…ç½®ç•Œé¢

* serverï¼šå‰ç«¯ä½¿ç”¨ nodejs å°è£…çš„æœåŠ¡ï¼Œå…¶ä¸­åŒ…æ‹¬ wsã€httpã€fs ç­‰ã€‚

* common-electronï¼šelectron çª—å£åˆå§‹åŒ–å…¥å£

![](https://img-blog.csdnimg.cn/direct/800b2a66f92a489686651173180ca158.jpeg#pic_center)

## 3.4. æ•™å¸ˆç«¯é€šè®¯åŸºæœ¬æµç¨‹

å¯åŠ¨ï¼š

1. åç«¯è°ƒèµ·æ¥æˆ‘ä»¬çš„ common-electronï¼ˆè¿è¡Œ/common-electron/main.jsï¼‰ï¼Œå¯¹ electron è¿›ç¨‹åˆå§‹åŒ–

1. è°ƒç”¨ start.sh è¿è¡Œ server è¿›ç¨‹

1. è¿è¡Œå‰ç«¯ vue é¡¹ç›®

## 3.5. æ¶ˆæ¯é€šçŸ¥

åœ¨å¤šåª’ä½“çš„é¡¹ç›®ä¸­ï¼Œæ¶ˆæ¯åŸºæœ¬éƒ½æ˜¯å•å‘çš„ï¼ˆé™¤äº†å‰ç«¯è¯»å†™ server.jsonï¼Œå› ä¸ºè¯¥æ–¹æ³•æ˜¯é€šè¿‡ nodejs å‰ç«¯è‡ªå·±è¯»å–ï¼‰

## 3.6. ui -> serverï¼ˆå‰ç«¯åˆ°åç«¯ï¼‰

### 3.6.1. 1.vue ç«¯å‘é€ axios è¯·æ±‚ï¼ˆpostï¼‰ï¼Œurl æ ¼å¼ä¸ºï¼š/g/:type/:sub/:context?win=xï¼ˆä¸åç«¯æ¥å£æ–‡æ¡£åŒ¹é…ï¼‰

æ‰€æœ‰çš„é¡µé¢æ‰“å¼€æ—¶éƒ½ä¼šåŠ ä¸Š `win=x` æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°ï¼Œ`x` è¡¨ç¤ºå½“å‰æµè§ˆå™¨çª—å£çš„ id, æ˜¯ä¸ªæ•´æ•°ã€‚

è¯·æ±‚æ—¶å¿…é¡»åœ¨ body é‡Œé¢ä¼  json:

```json
{
"to": ["ip1", "ip2", "..."],['all']
"data": {}
}
```

```json
{
  "Channel": 1,
  "ChannelArr": [
    1
  ],
  "setlocalip": "172.21.15.105",
  "layoutAll": {
    "students": [
      {
        "key": "172.16.1.10",
        "i": "172.16.1.10",
        "isBlackScreen": false,
        "status": 1,
        "submitJobs": true,
        "isHandsUp": true,
        "computerName": "hzj",
        "student": "å¼ 1",
        "studentNum": "17103020101",
        "computerStatus": true,
        "defaultName": "asas",
        "ipSort": "172.16.1.10",
        "group": "9",
        "selected": false,
        "isGroupLeader": false,
        "loginTime": "2021-11-23 10: 17: 54",
        "isVoice": false,
        "voiceActive": "",
        "rewardNum": 0,
        "isAutoVoice": true
      },
      {
        "key": "172.16.1.11",
        "i": "172.16.1.11",
        "isBlackScreen": false,
        "status": 0,
        "submitJobs": true,
        "isHandsUp": true,
        "computerName": "LZD-20210402YCB",
        "student": "å¼ 2",
        "studentNum": "17103020102",
        "computerStatus": false,
        "defaultName": "adfs",
        "ipSort": "172.16.1.11",
        "group": "9",
        "selected": false,
        "isGroupLeader": false,
        "loginTime": "2021-11-23 10: 17: 54",
        "isVoice": false,
        "voiceActive": "",
        "rewardNum": 0,
        "isAutoVoice": true
      },
      {
        "key": "172.16.1.12",
        "i": "172.16.1.12",
        "isBlackScreen": false,
        "status": 0,
        "submitJobs": true,
        "isHandsUp": true,
        "computerName": "LZD-20210402YCC",
        "student": "å¼ 3",
        "studentNum": "17103020103",
        "computerStatus": true,
        "defaultName": "rqwe",
        "ipSort": "172.16.1.12",
        "group": "9",
        "selected": false,
        "isGroupLeader": false,
        "loginTime": "2021-11-23 10: 17: 54",
        "isVoice": false,
        "voiceActive": "",
        "rewardNum": 0,
        "isAutoVoice": true
      },
      {
        "key": "172.16.1.13",
        "i": "172.16.1.13",
        "isBlackScreen": false,
        "status": 0,
        "submitJobs": true,
        "isHandsUp": true,
        "computerName": "LZD-20210402YCD",
        "student": "å¼ 4",
        "studentNum": "17103020104",
        "computerStatus": true,
        "defaultName": "afvrrsas",
        "ipSort": "172.16.1.13",
        "group": "1",
        "selected": false,
        "isGroupLeader": true,
        "loginTime": "2021-11-23 10: 17: 54",
        "isVoice": false,
        "voiceActive": "",
        "rewardNum": 0,
        "isAutoVoice": true
      },
      {
        "key": "172.16.1.14",
        "i": "172.16.1.14",
        "isBlackScreen": false,
        "status": 0,
        "submitJobs": true,
        "isHandsUp": true,
        "computerName": "LZD-20210402YCE",
        "student": "å¼ 5",
        "studentNum": "17103020105",
        "computerStatus": true,
        "defaultName": "qsd",
        "ipSort": "172.16.1.14",
        "group": "1",
        "selected": false,
        "isGroupLeader": false,
        "loginTime": "2021-11-23 10: 17: 54",
        "isVoice": false,
        "voiceActive": "",
        "rewardNum": 0,
        "isAutoVoice": true
      },
      {
        "key": "172.16.1.15",
        "i": "172.16.1.15",
        "isBlackScreen": false,
        "status": 0,
        "submitJobs": true,
        "isHandsUp": true,
        "computerName": "LZD-20210402YCF",
        "student": "å¼ 6",
        "studentNum": "17103020106",
        "computerStatus": false,
        "defaultName": "hny",
        "ipSort": "172.16.1.15",
        "group": "1",
        "selected": false,
        "isGroupLeader": false,
        "loginTime": "2021-11-23 10: 17: 54",
        "isVoice": false,
        "voiceActive": "",
        "rewardNum": 0,
        "isAutoVoice": true
      },
      {
        "key": "172.16.1.16",
        "i": "172.16.1.16",
        "isBlackScreen": false,
        "status": 0,
        "submitJobs": true,
        "isHandsUp": true,
        "computerName": "LZD-20210402YCG",
        "student": "å¼ 7",
        "studentNum": "17103020107",
        "computerStatus": true,
        "defaultName": "ccc",
        "ipSort": "172.16.1.16",
        "group": "1",
        "selected": false,
        "isGroupLeader": false,
        "loginTime": "2021-11-23 10: 17: 54",
        "isVoice": false,
        "voiceActive": "",
        "rewardNum": 0,
        "isAutoVoice": true
      },
      {
        "key": "172.16.1.17",
        "i": "172.16.1.17",
        "isBlackScreen": false,
        "status": 0,
        "submitJobs": true,
        "isHandsUp": true,
        "computerName": "LZD-20210402YCW",
        "student": "å¼ 8",
        "studentNum": "17103020108",
        "computerStatus": true,
        "defaultName": "d",
        "ipSort": "172.16.1.17",
        "group": "1",
        "selected": false,
        "isGroupLeader": false,
        "loginTime": "2021-11-23 10: 17: 54",
        "isVoice": false,
        "voiceActive": "",
        "rewardNum": 0,
        "isAutoVoice": true
      },
      {
        "key": "172.16.1.18",
        "i": "172.16.1.18",
        "isBlackScreen": false,
        "status": 0,
        "submitJobs": true,
        "isHandsUp": true,
        "computerName": "LZD-20210402YCH",
        "student": "å¼ 9",
        "studentNum": "17103020109",
        "computerStatus": true,
        "defaultName": "ee",
        "ipSort": "172.16.1.18",
        "group": "1",
        "selected": false,
        "isGroupLeader": false,
        "loginTime": "2021-11-23 10: 17: 54",
        "isVoice": false,
        "voiceActive": "",
        "rewardNum": 0,
        "isAutoVoice": true
      },
      {
        "key": "172.16.1.19",
        "i": "172.16.1.19",
        "isBlackScreen": false,
        "status": 0,
        "submitJobs": true,
        "isHandsUp": true,
        "computerName": "LZD-20210402YCM",
        "student": "å¼ 10",
        "studentNum": "171030201010",
        "computerStatus": true,
        "defaultName": "www",
        "ipSort": "172.16.1.19",
        "group": "1",
        "selected": false,
        "isGroupLeader": false,
        "loginTime": "2021-11-23 10: 17: 54",
        "isVoice": false,
        "voiceActive": "",
        "rewardNum": 0,
        "isAutoVoice": true
      }
    ],
    "views": [
      {
        "key": "0",
        "desc": 1,
        "lock": false,
        "sortActive": "",
        "sortWay": 1,
        "colNum": 6,
        "showMode": "computerId",
        "title": "å…¨éƒ¨å­¦ç”Ÿ",
        "showSize": "mini",
        "child": [
          {
            "key": "172.16.1.10",
            "i": "172.16.1.10",
            "isBlackScreen": false,
            "status": 1,
            "submitJobs": true,
            "isHandsUp": true,
            "computerName": "hzj",
            "student": "å¼ 1",
            "studentNum": "17103020101",
            "computerStatus": true,
            "defaultName": "asas",
            "ipSort": "172.16.1.10",
            "group": "9",
            "selected": false,
            "isGroupLeader": false,
            "loginTime": "2021-11-23 10: 17: 54",
            "isVoice": true,
            "voiceActive": "",
            "rewardNum": 0,
            "isAutoVoice": true
          },
          {
            "key": "172.16.1.11",
            "i": "172.16.1.11",
            "isBlackScreen": false,
            "status": 0,
            "submitJobs": true,
            "isHandsUp": true,
            "computerName": "LZD-20210402YCB",
            "student": "å¼ 2",
            "studentNum": "17103020102",
            "computerStatus": false,
            "defaultName": "adfs",
            "ipSort": "172.16.1.11",
            "group": "9",
            "selected": false,
            "isGroupLeader": false,
            "loginTime": "2021-11-23 10: 17: 54",
            "isVoice": false,
            "voiceActive": "",
            "rewardNum": 0,
            "isAutoVoice": true
          },
          {
            "key": "172.16.1.12",
            "i": "172.16.1.12",
            "isBlackScreen": false,
            "status": 0,
            "submitJobs": true,
            "isHandsUp": true,
            "computerName": "LZD-20210402YCC",
            "student": "å¼ 3",
            "studentNum": "17103020103",
            "computerStatus": true,
            "defaultName": "rqwe",
            "ipSort": "172.16.1.12",
            "group": "9",
            "selected": false,
            "isGroupLeader": false,
            "loginTime": "2021-11-23 10: 17: 54",
            "isVoice": false,
            "voiceActive": "",
            "rewardNum": 0,
            "isAutoVoice": true
          },
          {
            "key": "172.16.1.13",
            "i": "172.16.1.13",
            "isBlackScreen": false,
            "status": 0,
            "submitJobs": true,
            "isHandsUp": true,
            "computerName": "LZD-20210402YCD",
            "student": "å¼ 4",
            "studentNum": "17103020104",
            "computerStatus": true,
            "defaultName": "afvrrsas",
            "ipSort": "172.16.1.13",
            "group": "1",
            "selected": false,
            "isGroupLeader": true,
            "loginTime": "2021-11-23 10: 17: 54",
            "isVoice": false,
            "voiceActive": "",
            "rewardNum": 0,
            "isAutoVoice": true
          },
          {
            "key": "172.16.1.14",
            "i": "172.16.1.14",
            "isBlackScreen": false,
            "status": 0,
            "submitJobs": true,
            "isHandsUp": true,
            "computerName": "LZD-20210402YCE",
            "student": "å¼ 5",
            "studentNum": "17103020105",
            "computerStatus": true,
            "defaultName": "qsd",
            "ipSort": "172.16.1.14",
            "group": "1",
            "selected": false,
            "isGroupLeader": false,
            "loginTime": "2021-11-23 10: 17: 54",
            "isVoice": false,
            "voiceActive": "",
            "rewardNum": 0,
            "isAutoVoice": true
          },
          {
            "key": "172.16.1.15",
            "i": "172.16.1.15",
            "isBlackScreen": false,
            "status": 0,
            "submitJobs": true,
            "isHandsUp": true,
            "computerName": "LZD-20210402YCF",
            "student": "å¼ 6",
            "studentNum": "17103020106",
            "computerStatus": false,
            "defaultName": "hny",
            "ipSort": "172.16.1.15",
            "group": "1",
            "selected": false,
            "isGroupLeader": false,
            "loginTime": "2021-11-23 10: 17: 54",
            "isVoice": false,
            "voiceActive": "",
            "rewardNum": 0,
            "isAutoVoice": true
          },
          {
            "key": "172.16.1.16",
            "i": "172.16.1.16",
            "isBlackScreen": false,
            "status": 0,
            "submitJobs": true,
            "isHandsUp": true,
            "computerName": "LZD-20210402YCG",
            "student": "å¼ 7",
            "studentNum": "17103020107",
            "computerStatus": true,
            "defaultName": "ccc",
            "ipSort": "172.16.1.16",
            "group": "1",
            "selected": false,
            "isGroupLeader": false,
            "loginTime": "2021-11-23 10: 17: 54",
            "isVoice": false,
            "voiceActive": "",
            "rewardNum": 0,
            "isAutoVoice": true
          },
          {
            "key": "172.16.1.17",
            "i": "172.16.1.17",
            "isBlackScreen": false,
            "status": 0,
            "submitJobs": true,
            "isHandsUp": true,
            "computerName": "LZD-20210402YCW",
            "student": "å¼ 8",
            "studentNum": "17103020108",
            "computerStatus": true,
            "defaultName": "d",
            "ipSort": "172.16.1.17",
            "group": "1",
            "selected": false,
            "isGroupLeader": false,
            "loginTime": "2021-11-23 10: 17: 54",
            "isVoice": false,
            "voiceActive": "",
            "rewardNum": 0,
            "isAutoVoice": true
          },
          {
            "key": "172.16.1.18",
            "i": "172.16.1.18",
            "isBlackScreen": false,
            "status": 0,
            "submitJobs": true,
            "isHandsUp": true,
            "computerName": "LZD-20210402YCH",
            "student": "å¼ 9",
            "studentNum": "17103020109",
            "computerStatus": true,
            "defaultName": "ee",
            "ipSort": "172.16.1.18",
            "group": "1",
            "selected": false,
            "isGroupLeader": false,
            "loginTime": "2021-11-23 10: 17: 54",
            "isVoice": false,
            "voiceActive": "",
            "rewardNum": 0,
            "isAutoVoice": true
          },
          {
            "key": "172.16.1.19",
            "i": "172.16.1.19",
            "isBlackScreen": false,
            "status": 0,
            "submitJobs": true,
            "isHandsUp": true,
            "computerName": "LZD-20210402YCM",
            "student": "å¼ 10",
            "studentNum": "171030201010",
            "computerStatus": true,
            "defaultName": "www",
            "ipSort": "172.16.1.19",
            "group": "1",
            "selected": false,
            "isGroupLeader": false,
            "loginTime": "2021-11-23 10: 17: 54",
            "isVoice": false,
            "voiceActive": "",
            "rewardNum": 0,
            "isAutoVoice": true
          }
        ]
      }
    ]
  },
  "input": 6,
  "teacherConfig": {
    "scene": "generalEducation",
    "machine": "teacherMachine",
    "serverIP": ""
  }
}

```

å‚æ•°è¯´æ˜

| g       | URL   |                 | å‰ç«¯æ ‡è¯†ï¼Œåªæœ‰ç»™åç«¯å‘çš„æ¶ˆæ¯å¸¦æœ‰/gæ ‡è¯†                        |
|---------|-------|-----------------|---------------------------------------------|
| type    | URL   | String          | å¤šåª’ä½“åè®®æ¶ˆæ¯ç±»å‹ï¼Œå‚è€ƒå¤šåª’ä½“æ–‡æ¡£ï¼Œåè®®ç‰ˆæœ¬ä½¿ç”¨ `v` å‚æ•°             |
| sub     | URL   | String          | å¤šåª’ä½“åè®®æ¶ˆæ¯å­ç±»å‹ï¼Œå¦‚æœæ˜¯ null, ä¼  `null`               |
| context | URL   | String          | å¤šåª’ä½“åè®®æ¶ˆæ¯å¯¹è±¡åï¼Œå¦‚æœæ˜¯ null, ä¼  `null`               |
| v       | query | Number          | å¤šåª’ä½“åè®®æ¶ˆæ¯ç‰ˆæœ¬                                   |
| to      | body  | `Array<String>` | å¤šåª’ä½“æ¶ˆæ¯é‡Œé¢çš„ `id` å­—æ®µï¼Œå³åç«¯ä¼šè¦æ±‚éœ€è¦å°†æ•™å¸ˆç«¯çš„æ¶ˆæ¯å‘ç»™å…·ä½“çš„å“ªå‡ å°å­¦ç”Ÿæœº |
| data    | body  | Object          | å¤šåª’ä½“æ¶ˆæ¯å¯¹è±¡å„å­—æ®µå€¼ï¼Œå¿…é¡»ä½¿ç”¨å°é©¼å³°å‘½åæ³•                      |

### 3.6.2. 2.express å¤„ç†è¯·æ±‚ï¼šå°† urlï¼Œä»¥åŠ post çš„ body è§£ææˆåç«¯è¦çš„ jsonï¼ˆcontextï¼šbase64 æ ¼å¼ï¼‰ï¼Œå¹¶è½¬æˆå­—ç¬¦ä¸²é€šè¿‡ ws å‘é€ç»™åç«¯

```js
router.post('/:type/:sub/:context', wsmw, function (req, res, next) {
  const version = req.query.v || 1
  const { type, sub, context } = req.params
  const { to, data } = req.body
  const contextstr = context === 'null' ? '' : encode(context, data)
  const json = {
 'type&name': type === 'common' ? type : `${type}:${version}`,
 sub: sub === 'null' ? null : sub,
 context: contextstr,
 id: global.config.isStudent ? '127.0.0.1' : to
  }
  req.send(json)
  res.json({ code: 0 })
})
```

### 3.6.3. ui.protoæ–‡ä»¶

å‰ç«¯éœ€è¦ä»åç«¯è¦è¿™ä¸ªæ–‡ä»¶ï¼Œå‰ç«¯ä¾èµ–è¿™ä¸ªæ–‡ä»¶ï¼Œä¸ç„¶ä¼ è¿‡å»çš„contextéƒ½æ˜¯nullï¼Œè€Œåç«¯è¦æ±‚è¿™ä¸ªæœ‰å€¼çš„ã€‚

è¯¥æ–‡ä»¶ä¼šé’ˆå¯¹å‰ç«¯ä¼ é€’çš„æ•°æ®ç»“æ„è¿›è¡Œæ ¡éªŒï¼Œå¦‚æœæ ¡éªŒä¸é€šè¿‡ï¼Œç›´æ¥æ˜¯ç©ºå­—ç¬¦ä¸²

### 3.6.4. å¤šåª’ä½“å·¥ä½œæµ

```bash

# æ•™å¸ˆæœºç•Œé¢ å¯åŠ¨
cd packages/teacher-ui
yarn serve

# electron å¯åŠ¨
cd packages/common-electron
yarn serve

# mmc-electron æ ¹ç›®å½• é™æ€ç›®å½• æä¾› ç«¯å£ 808x
http-server

# mmc-electron æ ¹ç›®å½• ç›´æ¥æ‰“åŒ…
yarn build

# æ•™å¸ˆæœº ä¸Šä¼  æœ¬åœ° app.asar åŒ… åˆ°è¿œç¨‹çš„æ•™å¸ˆæœºä¸Šçš„ èµ„æºåŒ…
sudo rm -rf app.asar /opt/mmc-server/bin/electron/resources/app.asar;wget http://172.21.15.105:8082/packages/common-electron/dist/linux-unpacked/resources/app.asar;sudo cp app.asar /opt/mmc-server/bin/electron/resources/

# /opt/mmc-server/bin ç›´æ¥å¯åŠ¨ å¤šåª’ä½“ electron åº”ç”¨ å‰æ ä½¿ç”¨åˆå§‹åŒ–çš„ client.jsonå’Œserver.json
$MMC_SERVER_BIN/electron/common-electron --no-sandbox --disable-gpu

# ç™»å½•ç•Œé¢ ç™»å½•æ¥å£ æ’æŸ¥å‘ç° code è¿”å›1 çš„åŸå›  å¦‚æœå‡ºç°äº†
# åˆ é™¤ /opt/mmc-server/bin/mmc.pid 
rm -f  /opt/mmc-server/bin/*.pid

# èµµä½³é‘«è¯´æ˜¯server.jsonæ²¡æƒé™ã€‚ä½†æˆ‘ç»™äº†å®Œæ•´æƒé™ å¯¼è‡´ç™»å½•ç•Œé¢æ‰“ä¸å¼€ä¸»ç•Œé¢ æŠ¥é”™æƒé™é”™è¯¯

# ubuntu å®‰è£…deb
sudo dpkg -i /root/æ¡Œé¢/mmc_2.1.0.0076-f7a90bdb.deb
apt install ./mmc_xxx
dpkg -r /opt/mmc-server

# ä¸Šä¼ æ–‡ä»¶åˆ°ftpä¸Š curl: (30) Could not resolve host: 21 æŠ¥é”™* Could not resolve host: 21 failed to resolve the address provided to PORT: 21 æ·»åŠ  -P - å‚æ•°æ¥å¯ç”¨è¢«åŠ¨æ¨¡å¼
curl -v -T ./packages/common-electron/dist/linux-unpacked/resources/app.asar -P 21 -u admin:'123qwe!@#' "ftp://172.16.227.19/CTSC%20files/äº§å“ç‰ˆæœ¬/å¤šåª’ä½“/test/" -P -

# åŒæ—¶ä¸Šä¼ å¤šä¸ªæ–‡ä»¶
curl -v -T "./packages/common-electron/dist/linux-unpacked/resources/{app.asar,version}" -P 21 -u admin:'123qwe!@#' "ftp://172.16.227.19/CTSC%20files/äº§å“ç‰ˆæœ¬/å¤šåª’ä½“/test/" -P -


# 2.1.0-HW
curl -v -T "./packages/common-electron/dist/linux-unpacked/resources/app.asar" -P 21 -u admin:'123qwe!@#' "ftp://172.16.227.19/CTSC%20files/äº§å“ç‰ˆæœ¬/å¤šåª’ä½“/test/2.1.0-HW/" -P -

# new 2.2.0
curl -v -T "./packages/common-electron/dist/linux-unpacked/resources/{app.asar,app.asar.version}" -P 21 -u admin:'123qwe!@#' "ftp://172.16.227.19/CTSC%20files/äº§å“ç‰ˆæœ¬/å¤šåª’ä½“/test/2.2.0/" -P -

# æŸ¥çœ‹è¿œç¨‹æ–‡ä»¶åˆ—è¡¨
curl -v -P 21 -u admin:'123qwe!@#' "ftp://172.16.227.19/CTSC%20files/äº§å“ç‰ˆæœ¬/å¤šåª’ä½“/test/" -P -
curl -P 21 -u admin:'123qwe!@#' "ftp://172.16.227.19/CTSC%20files/äº§å“ç‰ˆæœ¬/å¤šåª’ä½“/test/" -P -


# æ¥å£æ›´æ–° æ›´æ–° æ–‡ä»¶ electron-mmc\packages\server\protocol\ui.proto

```

### 3.6.5. webç«¯ mmcä»£ç é€»è¾‘

```js
# MMCTools.vue
window.oevdi.idpApp.on('mmc_message', this.dispatchMMC)

# dispatchMMCæ–¹æ³• apiTypes åˆ†æ”¯

# mmc-types.js
export const apiTypes = Object.freeze({
  CONNECTED: 'TSpaceConnected',
  DISCONNECTED: 'TSpaceDisconnected',
  STUINFO: 'LocalStuInfo',
  STUINFOUPD: 'UpdateLocalStuInfo',
  ADDSTU: 'BarrageStuMember',
  TOGGLE: 'SwitchUi',
  BARRAGE: 'Barrage',
  CAPTURE: 'ScreenShot',
  VOICE: 'Voice',
  VOICEUPD: 'StuVoice',
  VOICEOPERATE: 'TeaVoiceOper',
  BARRAGENTER: 'BarrageEnter',
  CMD: {
    BARRAGE: 'Barrage',
    CAST: 'NoteShot',
    BARRAGECLOSE: 'BarrageExit',
    CASTCLOSE: 'ShotExit',
    EXIT: 'Exit',
    // deprecated
    BARRAGE_CAST: 'BarrageNote'
  }
})


```

## 3.7. server -> uiï¼ˆåç«¯åˆ°å‰ç«¯ï¼‰

1. åç«¯é€šè¿‡ ws å‘é€æ¶ˆæ¯åˆ°å‰ç«¯

1. ä¸»è¿›ç¨‹ æ”¶åˆ°wsæ¶ˆæ¯åï¼Œ é€šè¿‡ä½¿ç”¨ win.webContents.send API å‘é€ä¸€ä¸ªåä¸ºâ€˜mmc-messageâ€™çš„æ¶ˆæ¯ï¼Œç„¶åä½¿ç”¨åœ¨preloadä¸­ä½¿ç”¨ ipcRenderer.on API æ¥æ”¶ã€‚

1. åœ¨æ”¶åˆ°â€˜mmc-messageâ€™çš„æ¶ˆæ¯åï¼Œä½¿ç”¨ dispatchEvent é€šè¿‡ windows æ´¾å‘è‡ªå®šä¹‰äº‹ä»¶ã€‚

1. åœ¨æ‰€éœ€è¦çš„é¡µé¢ä½¿ç”¨ windows.addEventListener ç›‘å¬å¤„ç†

> ipcRenderer
>
>
> ä»æ¸²æŸ“å™¨è¿›ç¨‹åˆ°ä¸»è¿›ç¨‹çš„å¼‚æ­¥é€šä¿¡ã€‚
>
>
> ipcMain
>
>
> ä»ä¸»è¿›ç¨‹åˆ°æ¸²æŸ“è¿›ç¨‹çš„å¼‚æ­¥é€šä¿¡ã€‚

### 3.7.1. æ³¨æ„

å‰åç«¯æ¶ˆæ¯è™½ç„¶æ˜¯é€šè¿‡ ws è¿›è¡Œä¼ è¾“ï¼Œä½†æ˜¯æ¶ˆæ¯å´æ˜¯æˆ‘ä»¬è¦ä»€ä¹ˆå†å»è¯·æ±‚ä»€ä¹ˆï¼Œä»–ä¸ä¼šä¸»åŠ¨å‘æˆ‘ä»¬æ¨é€ã€‚

ä¾‹å¦‚ï¼šä»¥ç¼©ç•¥å›¾äº¤äº’ä¸ºä¾‹ï¼ˆéœ€è¦å“ªå‡ å°çš„ç¼©ç•¥å›¾å°±å‘é€å“ªå‡ å°çš„ ip åœ°å€ï¼Œé€šè¿‡å‰ç«¯è½®è®­è¯·æ±‚ï¼‰

# 4. å¼€å‘ç¯å¢ƒé…ç½®

1. ä»ä»“åº“å°†ä»£ç  clone

1. åœ¨æœ€å¤–å±‚ install

1. è¿›å…¥/packages/common-electronï¼Œæ–°å»º server.json æ–‡ä»¶ï¼Œæ–°å»º env.dev æ–‡ä»¶

env.dev

```
NODE_ENV=development // å¼€å‘ç¯å¢ƒ
TYPE=teacher // è¿è¡Œæ•™å¸ˆç«¯
IP=172.16.43.8 // æœ¬æœº ip
PORT=3333 // å ç”¨ç«¯å£
SETUP=ture // æ˜¯å¦å·²ç»åˆå§‹åŒ–ï¼Œå³æ˜¯å¦è¿è¡Œ setup-ui
```

1. è¿›å…¥åˆ°/packages/teacher-uiï¼Œyarn serve è¿è¡Œæ•™å¸ˆç«¯ç•Œé¢

1. è¿›å…¥åˆ°/packages/common-electronï¼Œyarn serve è¿è¡Œ electron å£³å­

ï¼ˆè¿™é‡Œå¯ä»¥ä½¿ç”¨ wait-on æ¨¡å—æ¥ç­‰å¾… teacher-ui å ç”¨ç‰¹å®šç«¯å£ï¼Œç„¶åå†è¿è¡Œ common-electron çš„å¯åŠ¨å‘½ä»¤ï¼Œåªç”¨ä¸€æ¡å‘½ä»¤è¿è¡Œã€‚ä½†æ˜¯è¿™æ ·ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼šå‡å¦‚å‘½ä»¤ä¸º startï¼Œåˆ™è¿è¡Œäº† yarn start åï¼Œç­‰åˆ° common-electron è¿è¡Œå®Œåï¼Œè¯¥å‘½ä»¤æœ€åæ˜¾ç¤ºçš„åªä¼šæ˜¯ common-electrorn å ç”¨çš„åœ°å€ï¼Œå³ ctrl+c å–æ¶ˆè¿è¡Œä¹Ÿåªä¼šå–æ¶ˆ common-electronï¼Œä¸ä¼šå–æ¶ˆ teacher-ui çš„è¿è¡Œï¼Œè‹¥å†æ¬¡è¿è¡Œ startï¼Œåˆ™ä¼šå¤šæ¬¡è®© teacher-ui å ç”¨å¤šä¸ªç«¯å£ï¼‰

# 5. æ•™å¸ˆç«¯ä¸šåŠ¡

ä»¥çª—ä½“åˆ†ï¼šåˆ†ä¸ºä¸»çª—ä½“ã€æ‚¬æµ®æ ã€å¼¹çª—

## 5.1. ä¸»çª—ä½“

ä¸»çª—ä½“ï¼Œå³ç™»å½•ä»¥åŠä¸€äº›åŠŸèƒ½æŒ‰é’®å…¥å£ã€‚ä¸»çª—ä½“æ˜¯æœ‰ä¸¤ä¸ªè·¯ç”±ï¼Œåˆ†åˆ«ä¸º/loginã€/home

ç™»å½•é¡µå¯è¿›è¡Œæ“ä½œï¼šæ¿€æ´»ï¼ˆåœ¨çº¿ï¼Œç¦»çº¿ï¼‰

ä¸»é¡µé¢å¯è¿›è¡Œæ“ä½œï¼šå±å¹•å¹¿æ’­ã€å½±éŸ³å¹¿æ’­ã€å­¦ç”Ÿæ¼”ç¤ºã€é¥æ§è½¬æ’­ã€ä¸‹å‘ä½œä¸šã€æ”¶å–ä½œä¸šã€è¿œç¨‹å¼€æœºã€è¿œç¨‹å…³æœºã€è¾…åŠ©æ•™å­¦ï¼ˆé»‘å±è‚ƒé™ã€ç”µå­ç‚¹åã€ç”µå­ç™½æ¿ã€å±å¹•å½•åˆ¶ã€è¿œç¨‹é‡å¯ã€è¿œç¨‹å‘½ä»¤ï¼‰ã€è¯¾å ‚äº’åŠ¨ï¼ˆé¥æ§ç›‘çœ‹ã€å‡»é¼“ä¼ èŠ±ã€ç”µå­æŠ¢ç­”ã€è¯­éŸ³è¿éº¦ï¼‰ã€å›ºå®šä½ç½®ä¸Šæœºï¼ˆå›ºå®šä½ç½®ä¸Šæœºã€ç­çº§åº§ä½ç®¡ç†ï¼‰ã€äº‘æ•™å®¤ä¸Šä¸‹è¯¾

## 5.2. æ‚¬æµ®å·¥å…·æ 

æ‚¬æµ®å·¥å…·æ ï¼Œæ˜¯ç‹¬ç«‹äºä¸»çª—ä½“ä¹‹å¤–çš„å¦å¤–ä¸€ä¸ªçª—å£ã€‚åªä¸è¿‡ä¸æ˜¯é»˜è®¤çš„é¡µé¢ï¼Œè€Œæ˜¯ vue å»ºç«‹çš„å¤šé¡µé¢ï¼Œä½¿ç”¨ electron å±•ç°å‡ºä¸åŒçš„çª—ä½“ã€‚å³é€šè¿‡ new BrowserWindow åˆ›å»ºçš„æŒ‡å®šçª—å£

è¯¥å·¥å…·æ å…±æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼šçª—å£å¹¿æ’­ã€åŒºåŸŸå¹¿æ’­ã€å®æ—¶è¯­éŸ³ã€å±å¹•ç¬”ã€ç¬”è®°æˆªå±ã€å•å±æ§åˆ¶ã€å…¨ä½“æ§åˆ¶ã€è‡ªåŠ¨è½®è®­ã€ä¸Šä¸€é¡µã€ä¸‹ä¸€é¡µã€ç›‘çœ‹è®¾ç½®ã€é€€å‡ºã€æ”¶èµ·ã€å›ºå®š

åŠŸèƒ½æ ¹æ®ä¸åŒçš„å…¥å£å±•ç¤ºä¸åŒçš„ç»„åˆã€‚

## 5.3. å¼¹çª—

å¼¹çª—ï¼Œåœ¨å¤šåª’ä½“é¡¹ç›®ä¸­åˆ†ä¸ºä¸¤ç§å¼¹çª—ï¼Œä¸€ç§ä¼šå½±å“åˆ°ä¸»çª—ä½“(elementui çš„å¼¹çª—)ï¼Œä¸€ç§ä¸ä¼šå½±å“åˆ°ï¼ˆelectron çš„æ–°çª—ä½“ï¼‰ã€‚å³ä¸€ç§æ˜¯ element-ui è‡ªå¸¦çš„ï¼Œå¸¦æœ‰é®ç½©ä¸”åœ¨ä¸»çª—ä½“é‡Œé¢çš„ dialogï¼›å¦å¤–ä¸€ç§æ˜¯å’Œæ‚¬æµ®å·¥å…·æ ä¸€æ ·å¼¹çª—ï¼Œæ˜¯å¯ä»¥ç¼©å°åˆ°ä»»åŠ¡æ çš„ï¼Œä½¿ç”¨ new BrowserWindow åˆ›å»ºçš„æŒ‡å®šçª—å£ã€‚

ä½¿ç”¨ new BrowserWindow åˆ›å»ºçš„æŒ‡å®šçª—å£ï¼šè®¾ç½®ã€å…³äºã€ç›‘çœ‹è®¾ç½®ã€åŒºåŸŸå¹¿æ’­ã€æ¿€æ´»ã€ä¸‹å‘ä½œä¸šã€è¿œç¨‹å‘½ä»¤ã€é€€å‡ºã€åœ¨çº¿å®¢æœã€å‡»é¼“ä¼ èŠ±ã€ç”µå­æŠ¢ç­”

æ•™å¸ˆç«¯ç›®å½•

```
â”œâ”€api // äºŒæ¬¡å°è£…çš„ axios è¯·æ±‚
â”œâ”€assets
â”‚ â”œâ”€css // å…¬å…± css æ ·å¼
â”‚ â””â”€img // å›¾ç‰‡èµ„æº
â”œâ”€components // ç»„ä»¶ï¼ˆç™»å½•å¤´éƒ¨èœå•ã€ä¸»é¡µé¢å¤´éƒ¨èœå•ï¼‰
â”œâ”€mixins // å¯æ‹–æ‹½å¼¹çª—å¤´éƒ¨èœå•å…¬å…± mixin
â”œâ”€router // è·¯ç”±
â”œâ”€store // vuex
â”œâ”€utils // å…¬å…±æ–¹æ³•
â””â”€views
â”œâ”€home // ä¸»é¡µé¢å…¥å£
â”‚ Home.vue
â”œâ”€login // ç™»å½•é¡µé¢å…¥å£
â”‚ Login.vue
â””â”€viewTop // æ‚¬æµ®å·¥å…·æ å…¥å£
MonitorSet.vue
ViewTop.vue
```

# 6. è‡ªæµ‹è”è°ƒç­‰ç›¸å…³ä¿¡æ¯

## 6.1. è”è°ƒæµç¨‹

1. ç¯å¢ƒé…ç½®

    1. æ³¨å†Œ UOS æ¨¡æ¿ï¼Œå¹¶åŸºäºæ¨¡æ¿æ–°å»ºè™šæ‹Ÿæ•™å®¤ã€‚

    1. æ–°å»º vdi æ¡Œé¢ã€‚

    1. è¿›å…¥æ¡Œé¢ï¼Œå®‰è£… mmc deb å®‰è£…åŒ…ï¼Œå¯åŠ¨å­¦ç”Ÿæœºå¹¶åˆ‡æ¢ä¸ºæ•™å¸ˆæœºï¼ˆå¯†ç ï¼šOSeasyï¼‰ï¼Œè®¾ç½®æœåŠ¡å™¨ ipã€‚

    1. æ–°å»ºéšç§çª—å£è¿›å…¥å¦å¤–ä¸€ä¸ªæ¡Œé¢å¹¶å®‰è£… mmcï¼Œé…ç½®é¢‘é“å’Œæ•™å¸ˆæœºä¸€è‡´ã€‚

1. è”è°ƒ

    1. åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ `yarn build`ã€‚

    1. æŠŠ *packages\common-electron\dist\linux-unpacked\resources* ä¸­çš„ app.asar åŒ…æ›¿æ¢åˆ°æ¡Œé¢çš„ */opt/mmc-server/bin/electron/resources/* ä¸‹ã€‚

    1. é‡å¯æ¡Œé¢ä¸­çš„ mmc åº”ç”¨ã€‚

## 6.2. æµ‹è¯•ç¯å¢ƒ

* åœ°å€ï¼š172.16.228.5

## 6.3. build æµç¨‹

> smb è´¦å·ï¼šdmt å¯†ç ï¼š123456

1. `yarn build` â€”â€” teacher-ui å’Œ common-electronã€‚

1. `cd packages\common-electron\; robocopy.exe .\dist\linux-unpacked\resources \\172.20.4.46\06æµ‹è¯•å…±äº«\xufan app.asar /xo` å°†æ‰“åŒ…äº§ç‰©å‘å¸ƒåˆ°å…±äº« smb æœåŠ¡å™¨ä¸Šã€‚

1. å‰©ä¸‹çš„ç¼–è¯‘äº§ç‰©å¯ä»¥æäº¤åˆ° gitï¼Œä½†æ ¹æ®ç½—å‡¯è¯´çš„å®é™…ä¸Šæ²¡æœ‰ç”¨å¤„ï¼Œä¹Ÿå¯ä»¥ä¸æäº¤ã€‚

![](./files/1704786122058.å¤šåª’ä½“.md.png)

### 6.3.1. å…³äºæ¶æ„å·®å¼‚

å¦‚æœåªç»™ *app.asar* çš„è¯ï¼Œæ²¡æœ‰ä»»ä½•å·®å¼‚ï¼š

```
ğŸªŸ ğŸ•™[ 15:35:07 ] electron-mmc\packages\common-electron on î‚  2.1.0 [âœ˜!?â‡¡1] via îœ˜ v16.20.0 using ğŸ 72%
PS â¯ Get-FileHash .\dist\linux-unpacked\resources\app.asar

Algorithm       Hash                                                                   Path
---------       ----                                                                   ----
SHA256          51E2CEDD1067F88062D97FDF86729BCD45F6211C5D966A9CCE697E27B7102BCB       X:\working\electron-mmc\paâ€¦

ğŸªŸ ğŸ•™[ 15:47:13 ] electron-mmc\packages\common-electron on î‚  2.1.0 [âœ˜!?â‡¡1] via îœ˜ v16.20.0 using ğŸ 73%
PS â¯ Get-FileHash .\dist\linux-arm64-unpacked\resources\app.asar

Algorithm       Hash                                                                   Path
---------       ----                                                                   ----
SHA256          51E2CEDD1067F88062D97FDF86729BCD45F6211C5D966A9CCE697E27B7102BCB       X:\working\electron-mmc\paâ€¦
```

## 6.4. å¤šåª’ä½“å®‰è£…åŒ…è·¯å¾„

1. ftp://user@172.16.227.19/CTSC%20files/%B2%FA%C6%B7%B0%E6%B1%BE/%B6%E0%C3%BD%CC%E5/2.1.0/
2. ![image.png](https://raw.githubusercontent.com/zaggerj/obsidian_picgo/main/obsidian/20240812110321.png)

3. æ¨¡æ¿å¯†ç ï¼šlinhq
4. OSeasy è®¾ç½®å¯†ç 
5. windowsç‰ˆæœ¬ xf xf111111 172.16.62.200 hzj 1234qwer
6. ä½¿ç”¨ asar è§£å‹è¿‡ appä¹‹å æ‰§è¡Œåï¼Œä¸€è‡´é»˜è®¤è¯»å–è§£å‹åæ–‡ä»¶å¤¹çš„å†…å®¹  ä¸€è‡´æ— æ³•æ›¿æ¢åŒ…èµ„æºã€‚æäº†ä¸€ä¸Šåˆã€‚

```bash
npm install asar -g
asar extract myapp.asar myapp_extracted
```

ssh å¤±è´¥é—®é¢˜æ’æŸ¥

```bash
systemctl status ssh
systemctl start ssh
```

### 6.4.1. å¤šåª’ä½“è¯­éŸ³è¿éº¦çŠ¶æ€

å­¦ç”Ÿåç§°ï¼š`stuName = item.defaultName ? item.defaultName : (item.student ? item.student : item.computerName)`

![](https://raw.githubusercontent.com/zaggerj/obsidian_picgo/main/obsidian/20240822155214.png)

çŠ¶æ€ï¼š

```js
// çŠ¶æ€
// 1. æ•™å¸ˆæœºæ“ä½œçŠ¶æ€ æŒ‡ä»¤çŠ¶æ€ å‰ç«¯å‘è¿‡å»çš„
// typedef enum æšä¸¾å®šä¹‰
// {
// EM_VOICE_CMD_ALLOW_OPEN = 1,// å…è®¸è¯­éŸ³å¼€éº¦(å­¦ç”Ÿå¯æ§) æ“ä½œï¼š ä¸€æ¥å…¥ allow
// EM_VOICE_CMD_AUTO_OPEN,// è‡ªåŠ¨å¼€éº¦æŸå­¦ç”Ÿ(å­¦ç”Ÿå¯æ§) æ“ä½œï¼šæ¥å…¥å¹¶è§£é™¤é™éŸ³ auto æ¥å…¥å¹¶å¼€éº¦
// EM_VOICE_CMD_EXIT,// é€€å‡ºè¯­éŸ³è¿æ¥
// EM_VOICE_CMD_ELEC_SEL,// å­¦ç”Ÿæœºå¼€å¯éº¦å…‹é£å£°éŸ³(ç”µå­æŠ¢ç­”ç”¨ï¼Œå¼€éº¦)
// EM_VOICE_CMD_ELEC_NO_SEL,// å­¦ç”Ÿæœºå¼€å¯æ¥æ”¶éº¦å…‹é£å£°éŸ³(ç”µå­æŠ¢ç­”ç”¨ï¼Œä¸å¼€éº¦)
// EM_VOICE_CMD_OPEN,//è¯­éŸ³å¼€éº¦(å­¦ç”Ÿå¯æ§)
// EM_VOICE_CMD_CLOSE,//è¯­éŸ³å…³éº¦(å­¦ç”Ÿå¯æ§)
// }VOICE_CMD_TYPE;

// 2. å¼€å¯åçš„è¯­éŸ³è¿éº¦çŠ¶æ€ æ˜¾ç¤ºçŠ¶æ€ windows å’Œlinux ä¸€è‡´ï¼Œå…±ç”¨ä¸€å¥—
// statuså°±è¿™å‡ ç§çŠ¶æ€
// #define VOICE_STATUS_ON_TALKING 1 // å¼€éº¦è¯´è¯ä¸­
// #define VOICE_STATUS_ON_NO_TALK 2 // å¼€éº¦æ²¡è¯´è¯
// #define VOICE_STATUS_SLIENT     3 // æ™®é€šé™éŸ³(å­¦ç”Ÿå¯å¼€éº¦) è‡ªå·±å…³ æ¥å…¥ å°±æ˜¯é™éŸ³çŠ¶æ€
// #define VOICE_STATUS_OFF        4 // å…³éº¦ =ã€‹ æ–­å¼€ï¼Œä¸èƒ½è®²è¯ï¼Œä½†æ˜¯å¯ä»¥å¬ï¼Œå¯ä»¥æ¥å…¥è¿›æ¥ã€‚
// #define VOICE_STATUS_FORBIT     5 // å¼ºåˆ¶é™éŸ³(å­¦ç”Ÿä¸å¯å¼€éº¦) è€å¸ˆå…³ è¢«é™éŸ³æ“ä½œäº†

// å­¦ç”Ÿæœº ä¸ŠæŠ¥çŠ¶æ€ VOICE_STATUS å­¦ç”Ÿæœº ä¸ŠæŠ¥ è‡ªèº«æœ€ç»ˆçŠ¶æ€
// typedef enum æšä¸¾å®šä¹‰
// {
// EM_VOICE_STATUS_OPEN = 1,// å¼€éº¦(å­¦ç”Ÿå¯æ§)
// EM_VOICE_STATUS_CLOSE,// å…³éº¦(å­¦ç”Ÿå¯æ§)
// EM_VOICE_STATUS_EXIT,// é€€å‡º
// EM_VOICE_STATUS_OPEN_NO_CTRONL,// å¼€éº¦(å­¦ç”Ÿä¸å¯æ§)
// EM_VOICE_STATUS_CLOSE_NO_CTRONL,// å…³éº¦(å­¦ç”Ÿä¸å¯æ§)
// }VOICE_STATUS
```

## 6.5. 6.5

 äº¤æ¥-ç®¡ç†å°

## 6.6. é—ç•™/å¾…ä¼˜åŒ– Bugã€ä»»åŠ¡

## 6.7. ä¸»è¦åŠŸèƒ½

### 6.7.1. æ•™å®¤/ç»‘å®šå¯¹æ¥æ•™å®¤

#### 6.7.1.1. å‡ºç°æ¡ä»¶

* `/8081/thor/init/lang` æ¥å£è¿”å›å­—æ®µä¸­åŒ…æ‹¬ `sync_school: true`
* **è§’è‰²æƒé™è®¾ç½®ä¸­å¼€å¯äº†å¯¹åº”æƒé™**

#### 6.7.1.2. å…³é”®ä»£ç 

`js/vdi/menus.js` ä¸­æ·»åŠ è·¯ç”± meta ä¿¡æ¯ï¼š

```js
{
 key: 'Bind_Classroom',
 value: 'ç»‘å®šå¯¹æ¥æ•™å®¤',
 is_group: false,
 belong: 'Terminal',
 url: '/terminal/class-binding',
 only_show_when_synced: true /* meta */
}
```

`js/vdi/user/common.js` ä¸­ä¿®æ”¹ `filterMenusSrv`ï¼ŒåŸå…ˆä»£ç æ²¡æœ‰ TSpace æ‰ä¼šè°ƒç”¨ filterFn è¿‡æ»¤èœå•ï¼Œæ¿€æ´» TSpace åˆ™åŸæ ·è¿”å›ï¼Œå½“å‰å¤„ç†æ˜¯æ–°æ·»åŠ ä¸€ä¸ª `filterTSpaceFn`ï¼ŒåŒæ—¶å…¼é¡¾äº†æƒé™è®¾ç½®èœå•ä¸­çš„æ˜¾ç¤ºéšè—æ§åˆ¶ã€‚

```js
.factory('filterMenusSrv', function (PROD) {
    const menusCopy = angular.copy(menus)
    const filterFn = function (item) {
      if (!PROD.TSpace && item.only_show_when_tspace) return false
      if (PROD.TSpacePE && item.hide_when_tspace_pe) return false
      if (PROD.miniDeploy && item.hide_when_mini_deploy) return false
      if (PROD.vdiStandalone && item.hide_when_only_vdi) return false
      if (!PROD.syncSchool && item.only_show_when_synced) return false /**/
      if (item.sublist) item.sublist = item.sublist.filter(filterFn)
      return true
    }
    const filterTSpaceFn = item => {
      if (!PROD.syncSchool && item.only_show_when_synced) return false /**/
      if (item.sublist) item.sublist = item.sublist.filter(filterTSpaceFn)
      return true
    }
 
    if (!PROD.miniDeploy && !PROD.vdiStandalone && PROD.TSpace && !PROD.TSpacePE) {
      return menusCopy.filter(filterTSpaceFn)
    }
    return menusCopy.filter(filterFn)
  })
```

### 6.7.2. åç«¯åˆ†é¡µè¾…åŠ©æŒ‡ä»¤

## 6.8. åç»­ä¿®æ”¹éœ€è¦æ³¨æ„çš„

### 6.8.1. *58892* Bug

å½“å‰çš„è§£å†³æ–¹æ¡ˆæ˜¯ä¸è€ƒè™‘ i18nï¼Œä½†å¦‚æœåšè‹±æ–‡ç‰ˆè¿™é‡Œéœ€è¦å…¼å®¹ã€‚

### 6.8.2. ç»ˆç«¯ç®¡ç†é«˜åº¦æº¢å‡º

æŒªåˆ°å­é¡µé¢åé¡µé¢ç»“æ„å‘ç”Ÿå˜åŒ–ï¼Œä¸´æ—¶ä½¿ç”¨`vh`å¤„ç†ã€‚

```html
<div
  class="table-responsive"
  ng-style="{ height: getSelectedRows().length > 0 ? 'calc(100% - 70px)' : 'calc(100vh - 244px)' }">
</div>
```

### 6.8.3. *58565* ç»ˆç«¯ç®¡ç†é¡µé¢æç¤ºæ˜¾ç¤ºé—®é¢˜

æ˜¯å’Œé¡µé¢è·¯ç”±æœ‰å…³çš„ï¼Œå¦‚æœæ›´æ”¹é¡µé¢å±‚çº§æˆ–è·¯ç”±éœ€è¦æ³¨æ„ã€‚

æ›´æ”¹ä¹‹åéœ€è¦åœ¨ *js/vdi/vdi.js* çš„ `helpTip` directive ä¸­é…ç½®ï¼š

```js
if (/^\/resource\/network\/\d+\/?$/.test(path)) {
  path = '/resource/network/:id'
} else if (/^\/desktop\/teach\/\d+\/?$/.test(path)) {
  path = '/desktop/teach/:id'
} else if (/^\/terminal\/classes\/clients\/?$/.test(path)) {
  getSceneTipKey('/terminal/classes/clients', 'voi', 'TERMINAL_TAB')
  if ($scope.PROD.vdiStandalone) {
 path = ''
 $scope.tipKey = ''
  }
} else if (/^\/desktop\/scene\/?$/.test(path)) {
  getSceneTipKey('/desktop/scene', ['idv', 'voi'], 'SCENE_TAB')
}
```

## 6.9. 6.9

 äº¤æ¥-TSpace

## 6.10. mmc ç¯å¢ƒé…ç½®

> * å¤šåª’ä½“å®‰è£…åŒ…è·¯å¾„ï¼š"<ftp://user@172.16.227.19/CTSC%20files/%B2%FA%C6%B7%B0%E6%B1%BE/%B6%E0%C3%BD%CC%E5/10.9.1/10.9.1.5433/SetupV10.9.1.5433.exe>"
> * å­¦ç”Ÿæœºè®¾ç½®é»˜è®¤å¯†ç ï¼šOSeasy

1. æ–°å»ºè™šæ‹Ÿæ•™å®¤
    * ç»‘å®šæ¡Œé¢ ip
1. æ–°å»º vdi æ•™å­¦æ¡Œé¢
    * win10 æ¨¡æ¿
    * ä¸è¿˜åŸ
    * æ¿€æ´»åœºæ™¯
1. TSpace å¼•å…¥å’Œå¼€æ”¾åˆ›å»ºçš„æ•™å®¤ã€‚
1. æ‰“å¼€ä¸¤ä¸ªæ¡Œé¢ï¼Œåˆ†åˆ«å®‰è£…å¹¶é…ç½®ä¸ºæ•™å®¤æœºå’Œå­¦ç”Ÿæœºã€‚
1. `mv '.\general.conf' $env:APPDATA\Mmc\` æ¿€æ´»æ•™å¸ˆæœºæˆæƒã€‚

*general.conf*

```
/RegisterType/0/
```

![](./files/1719545934502.äº¤æ¥-TSpace.png)
![](./files/1719546292018.äº¤æ¥-TSpace.png)
