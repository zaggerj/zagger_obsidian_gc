---
created: 2023-11-06T08:20
updated: 2023-11-06T08:20
---
# readme

# 预研项目

## 需求

## 管理台现状

* 梳理下管理台启动之后的逻辑，包含登录相关的逻辑。
  * bootstrap.js
    * 首先程序一启动就开始调用了五个接口
    * 分别返回了相关数据
      * /thor/get\_controller\_ha\_status：获取ha状态，返回is\_split\_brain，如果是true直接返回裂脑url，如果是false调用第二个接口
      * /v1/node/status：获取节点状态，返回is\_control\_node，如果是false，直接返回初始化url，如果是true，继续调用第三个接口
      * /init/step：获取当前激活步骤，如果返回-1，返回location.pathname或者/根路径；如果返回不是-1，返回初始化url；如果该接口返回失败，同样返回初始化url
      * /8081/thor/init/lang：上一个promise返回的path路径，回调处理授权相关的信息
      * /8081/thor/admin/default-logo-name：获取默认的logo图片的名称
      * 最后不管成功失败，都要进行angularjs应用的启用，而嵌入项目，需要从这里开始，从vue项目-跳转到这边，就开始获取所有的变量。然后统一初始-化所有angularjs中需要用到的常量服务
* 发现一个问题，如果处于init.html 或者 裂脑 页面，如果初始化完成了，又需要跳转到登录界面，然后又要确定如何跳转到默认界面
* **页面跳转需要重新找需要确定下方案**
  * 登录几个平台：底层（管理台，资源管理台），服务管理门户（原管理账号，角色相关-底层平台设置），用户门户（普通账号，学生还是老师，是uaa那边的属性，包括组织）
  * 账号类型
  * 跳转情况 init =》 OMO授权？用户门户，未登录 ：login =》 底层（管理界面） ？ 服务管理 ？门户
  * 带好意图
    * 入口 =》点击门户山的教室或者桌面库tab页面，就优先进，用户门户
    * 默认门户，点击登录按钮
* 梳理登录相关
  * 登录平台：
    * 底层平台，简称"底层"，又称管理台和资源管理台
    * 服务管理门户，简称"服务管理"
    * 用户门户，简称"门户"
    * 原个人桌面web端，现复用门户-我的桌面的下半部分，带上logo一行，简称："新个人桌面"
  * 账号类别：
    * 管理账号：可以登录底层，服务管理，也可以登录门户（当作老师登录），还可以登录新个人桌面。
    * 普通账号：只能登录门户或者新个人桌面
  * 精简界面：干掉原来的/p路径的界面，直接复用门户-我的桌面的下半部分。
  * 统一登录入口：底层，底层新个人桌面，区域管理平台，服务管理，用户门户，全部统一为一个入口。
  * 界面显示逻辑：
    * 未初始化，进入init.html界面
    * 初始化过了，没有OMO授权，首先进入统一登录界面，管理账号，默认进底层管理台，普通账号默认进新个人登录界面。
    * 初始化过了，有OMO授权，默认进入门户平台-首页，处于未登录的门户平台，右上角有登录按钮，除了首页可以查看，其他tab页面不能进入，但是可以点击，拥有用户点击行为导向的特点。
    * 用户点击行为导向：当用户点击tab页面，不管是管理账号还是普通账号，先跳转底层统一登录界面，并且优先进入门户平台，其次进入配置的默认门户平台；当用户点击登录按钮，直接跳转底层统一登录界面，优先进入配置默认门户平台。
    * 管理帐号默认门户是  底层平台（概要）；用户帐号默认门户是  用户门户（首页）。
* 开始准备重构
* 最终方案：
  * angularjs中

## vue技术栈

## 维护现状

## 项目入口统一

## 登录逻辑整理
